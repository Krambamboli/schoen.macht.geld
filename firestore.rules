
rules_version = '2';

service cloud.firestore {
  match /databases/{database}/documents {

    /**
     * @description
     *   Manages 'Title' documents, representing tradable assets. Data is public for
     *   reading, and write operations are allowed for authenticated users.
     * @path
     *   /titles/{titleId}
     */
    match /titles/{titleId} {
      // Allow anyone to read individual title documents and list the entire collection.
      // This is safe as the data is intended for public display.
      allow read: if true;

      // Allow any authenticated user to create a new title.
      // We will use anonymous authentication for the registration and swipe kiosks.
      allow create: if request.auth != null;

      // Allow any authenticated user to update a title.
      // This is necessary for the swipe kiosk to update stock values.
      allow update: if request.auth != null;
      
      // Deleting titles is not part of the application's functionality.
      allow delete: if false;
    }
  }
}
